<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ProdDash ‚Äî Remodeled Productivity SPA</title>
  <meta name="description" content="ProdDash ‚Äî Professional productivity SPA: Dashboard, Tasks (Kanban), Habits, Calendar, Settings. Light & dark themes." />
  <style>
    /* ================= THEME / DESIGN TOKENS ================= */
    :root{
      --bg: #f3f6fb;
      --panel: #ffffff;
      --muted: #6b7280;
      --text: #0b1220;
      --accent-1: #6d28d9; /* purple */
      --accent-2: #06b6d4; /* teal */
      --glass: rgba(255,255,255,0.6);
      --radius: 16px;
      --card-shadow: 0 10px 30px rgba(12,18,36,0.06);
      --ease: cubic-bezier(.2,.9,.3,1);
      --width-max: 1280px;
    }
    [data-theme="dark"]{
      --bg: linear-gradient(180deg,#041026,#07142a);
      --panel: #071428;
      --muted: #9aa9c6;
      --text: #e6eef8;
      --card-shadow: 0 14px 40px rgba(2,6,23,0.6);
    }

    /* ================= BASE ================= */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text);display:flex;justify-content:center;padding:20px;transition:background .36s var(--ease)}
    .app{width:100%;max-width:var(--width-max);display:grid;grid-template-columns:72px 1fr;gap:20px;min-height:calc(100vh - 40px)}

    /* ================= SIDEBAR (slim) ================= */
    nav.sidebar{background:linear-gradient(180deg,var(--panel), color-mix(in srgb,var(--panel) 90%, var(--glass) 10%));border-radius:20px;padding:14px;box-shadow:var(--card-shadow);display:flex;flex-direction:column;align-items:center;gap:12px}
    .sb-logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));display:grid;place-items:center;color:white;font-weight:700}
    .sb-actions{display:flex;flex-direction:column;gap:6px;width:100%}
    .icon-btn{width:48px;height:48px;border-radius:12px;border:0;background:transparent;color:var(--muted);display:grid;place-items:center;cursor:pointer}
    .icon-btn.active{background:color-mix(in srgb,var(--accent-1) 10%, transparent);color:var(--accent-1)}
    .sb-bottom{margin-top:auto;display:flex;flex-direction:column;gap:8px;align-items:center}
    .sb-toggle{width:44px;height:44px;border-radius:10px;border:0;background:transparent;cursor:pointer}

    /* ================= TOPBAR ================= */
    header.topbar{grid-column:2/3;display:flex;align-items:center;justify-content:space-between;gap:12px}
    .search{flex:1;display:flex;gap:12px;align-items:center}
    .search input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid color-mix(in srgb,var(--muted) 8%, transparent);background:var(--panel)}
    .top-actions{display:flex;gap:10px;align-items:center}
    .avatar{width:40px;height:40px;border-radius:999px;background:linear-gradient(135deg,var(--accent-2),var(--accent-1));display:grid;place-items:center;color:white;font-weight:700}

    /* ================= VIEWPORT ================= */
    main.viewport{grid-column:2/3;background:transparent}
    .page{display:none;opacity:0;transform:translateY(6px);transition:opacity .28s var(--ease), transform .28s var(--ease)}
    .page.active{display:block;opacity:1;transform:none}

    /* ================= GRID & CARDS ================= */
    .layout{display:grid;grid-template-columns:1fr 360px;gap:20px}
    .card{background:var(--panel);padding:18px;border-radius:var(--radius);box-shadow:var(--card-shadow)}
    h1,h2{margin:0}
    h2{font-size:16px}
    .muted{color:var(--muted)}

    /* KPI row */
    .kpis{display:flex;gap:12px}
    .kpi{flex:1;padding:14px;border-radius:12px;background:linear-gradient(180deg,color-mix(in srgb,var(--panel) 98%, transparent),transparent)}
    .kpi strong{display:block;font-size:20px}

    /* sparkline (canvas placeholder) */
    .spark{height:48px}

    /* KANBAN */
    .kanban{display:flex;gap:12px;align-items:flex-start}
    .col{flex:1;min-width:220px;display:flex;flex-direction:column;gap:10px}
    .col .col-title{display:flex;justify-content:space-between;align-items:center}
    .task-card{background:linear-gradient(180deg,color-mix(in srgb,var(--panel) 96%, transparent),transparent);padding:10px;border-radius:12px;border:1px solid color-mix(in srgb,var(--muted) 6%, transparent);cursor:grab}
    .task-card.dragging{opacity:0.6;transform:scale(.98)}

    /* HABITS: circular progress */
    .habits-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px}
    .ring{display:grid;place-items:center;padding:12px}

    /* CALENDAR */
    .calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
    .day{min-height:96px;padding:10px;border-radius:10px;background:linear-gradient(180deg,color-mix(in srgb,var(--panel) 96%, transparent),transparent);border:1px solid color-mix(in srgb,var(--muted) 4%, transparent)}

    /* SETTINGS */
    .settings-grid{display:grid;grid-template-columns:1fr 320px;gap:12px}

    /* RESPONSIVE */
    @media (max-width:1000px){.app{grid-template-columns:72px 1fr}.layout{grid-template-columns:1fr}.card{padding:12px}}
    @media (max-width:720px){body{padding:12px}.app{grid-template-columns:1fr}.sidebar{position:fixed;left:12px;top:12px;bottom:12px;width:260px;transform:translateX(-110%);transition:transform .28s var(--ease);z-index:60}.sidebar.open{transform:translateX(0)}.search{display:none}}

    /* focus states */
    button:focus,input:focus{outline:3px solid color-mix(in srgb,var(--accent-1) 25%, transparent);outline-offset:3px}

  </style>
</head>
<body data-theme="light">
  <div class="app" id="app" role="application" aria-label="ProdDash remodeled">

    <nav class="sidebar" aria-label="Primary navigation" id="sidebar">
      <div class="sb-logo" title="ProdDash">PD</div>
      <div class="sb-actions" role="navigation" aria-label="Main">
        <button class="icon-btn" data-route="#dashboard" title="Dashboard">üè†</button>
        <button class="icon-btn" data-route="#tasks" title="Tasks">üóÇÔ∏è</button>
        <button class="icon-btn" data-route="#habits" title="Habits">üîÅ</button>
        <button class="icon-btn" data-route="#calendar" title="Calendar">üìÖ</button>
        <button class="icon-btn" data-route="#settings" title="Settings">‚öôÔ∏è</button>
      </div>
      <div class="sb-bottom">
        <button id="newQuick" class="icon-btn" title="Quick new">Ôºã</button>
        <button id="themeToggle" class="sb-toggle" title="Toggle theme">üåì</button>
      </div>
    </nav>

    <main class="viewport">
      <header class="topbar">
        <div class="search">
          <input id="globalSearch" placeholder="Search tasks, habits, notes... (press /)" aria-label="Global search" />
        </div>
        <div class="top-actions">
          <button id="notifBtn" class="icon-btn" title="Notifications">üîî</button>
          <div class="avatar" title="Profile">U</div>
        </div>
      </header>

      <!-- Pages -->
      <section id="dashboard" class="page" tabindex="0">
        <div class="layout">
          <div>
            <h1>Welcome back</h1>
            <p class="muted">Overview of your productivity</p>

            <div style="height:18px"></div>
            <div class="kpis">
              <div class="kpi card">
                <strong id="kpi-tasks">0</strong>
                <div class="muted">Open tasks</div>
                <canvas class="spark" id="sparkTasks" width="160"></canvas>
              </div>
              <div class="kpi card">
                <strong id="kpi-habits">0</strong>
                <div class="muted">Active habits</div>
                <canvas class="spark" id="sparkHabits" width="160"></canvas>
              </div>
              <div class="kpi card">
                <strong id="kpi-streak">0</strong>
                <div class="muted">Best streak</div>
                <canvas class="spark" id="sparkProd" width="160"></canvas>
              </div>
            </div>

            <div style="height:18px"></div>
            <div class="card">
              <h2>Recent activity</h2>
              <div id="recent" style="margin-top:12px"></div>
            </div>

            <div style="height:12px"></div>
            <div class="card" style="margin-top:12px">
              <h2>Tasks Kanban (Quick)</h2>
              <div id="miniKanban" style="margin-top:12px;display:flex;gap:8px"></div>
            </div>

          </div>

          <aside>
            <div class="card">
              <h2>Streaks & Habits</h2>
              <div class="habits-grid" id="dashHabits" style="margin-top:12px"></div>
            </div>
            <div class="card" style="margin-top:12px">
              <h2>Calendar (This month)</h2>
              <div id="miniCal" style="margin-top:12px"></div>
            </div>
          </aside>
        </div>
      </section>

      <section id="tasks" class="page" tabindex="0">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h2>Tasks</h2>
            <div class="muted">Kanban board ‚Äî drag tasks between columns</div>
          </div>
          <div style="height:12px"></div>
          <div class="kanban" id="kanbanBoard">
            <div class="col" data-col="todo">
              <div class="col-title"><strong>To Do</strong><button class="icon-btn" id="addTodo">Ôºã</button></div>
              <div class="col-list" data-list="todo"></div>
            </div>
            <div class="col" data-col="inprogress">
              <div class="col-title"><strong>In Progress</strong></div>
              <div class="col-list" data-list="inprogress"></div>
            </div>
            <div class="col" data-col="done">
              <div class="col-title"><strong>Done</strong></div>
              <div class="col-list" data-list="done"></div>
            </div>
          </div>
        </div>
      </section>

      <section id="habits" class="page" tabindex="0">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center"><h2>Habits</h2><button id="addHabitFull" class="btn">Ôºã New Habit</button></div>
          <div style="height:12px"></div>
          <div class="habits-grid" id="habitsFull"></div>
        </div>
      </section>

      <section id="calendar" class="page" tabindex="0">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center"><h2>Calendar</h2><div class="muted" id="monthLabel"></div></div>
          <div style="height:12px"></div>
          <div class="calendar" id="calendarGrid"></div>
        </div>
      </section>

      <section id="settings" class="page" tabindex="0">
        <div class="settings-grid">
          <div class="card">
            <h2>Profile</h2>
            <label style="margin-top:8px">Display name</label>
            <input id="settingName" type="text" style="width:100%;padding:10px;border-radius:8px;margin-top:6px;" />
            <label style="margin-top:12px">Email</label>
            <input id="settingEmail" type="text" style="width:100%;padding:10px;border-radius:8px;margin-top:6px;" />
            <div style="margin-top:12px;display:flex;justify-content:flex-end"><button id="saveSettings" class="btn">Save</button></div>
          </div>

          <div class="card">
            <h2>Appearance</h2>
            <p class="muted" style="margin-top:8px">Theme & preferences</p>
            <div style="margin-top:12px;display:flex;gap:8px">
              <button class="btn" data-theme="light">Light</button>
              <button class="btn" data-theme="dark">Dark</button>
            </div>
            <div style="margin-top:12px">
              <label>Compact density</label>
              <div style="display:flex;gap:8px;margin-top:8px"><button id="densityDefault" class="ghost">Default</button><button id="densityCompact" class="ghost">Compact</button></div>
            </div>
          </div>
        </div>
      </section>

    </main>

  </div>

  <template id="taskTpl">
    <div class="task-card" draggable="true">
      <div><strong class="t-title"></strong></div>
      <div class="muted t-desc" style="margin-top:6px;font-size:13px"></div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
        <div class="muted t-meta" style="font-size:12px"></div>
        <div>
          <button class="icon-btn t-edit">‚úé</button>
          <button class="icon-btn t-del">‚úï</button>
        </div>
      </div>
    </div>
  </template>

  <script>
    // =================== State & Persistence ===================
    const KEY = 'proddash.remodel.v1';
    const defaults = {
      tasks: [
        {id: id(), title:'Plan sprint goals', desc:'Outline deliverables', col:'todo', created:Date.now()-86400000},
        {id: id(), title:'Design README', desc:'Add screenshots', col:'inprogress', created:Date.now()-3600000},
        {id: id(), title:'Pay invoices', desc:'Check subscriptions', col:'done', created:Date.now()-86400000*3}
      ],
      habits: [ {id:id(), title:'Meditate', streak:4, progress:0.8}, {id:id(), title:'Exercise', streak:2, progress:0.3} ],
      settings: { name:'Prod User', email:'', theme:'light', density:'default' }
    };
    let state = JSON.parse(localStorage.getItem(KEY) || 'null') || defaults;
    function save(){ localStorage.setItem(KEY, JSON.stringify(state)); }
    function id(){ return Math.random().toString(36).slice(2,9) }

    // =================== Router ===================
    const pages = ['#dashboard','#tasks','#habits','#calendar','#settings'];
    function route(hash){ if(!pages.includes(hash)) hash='#dashboard'; document.querySelectorAll('.page').forEach(p=>p.classList.remove('active')); const el = document.querySelector(hash); if(el) el.classList.add('active'); // mark sidebar
      document.querySelectorAll('.icon-btn[data-route]').forEach(b=> b.classList.toggle('active', b.getAttribute('data-route')===hash));
      // render content as needed
      if(hash==='#dashboard') renderDashboard();
      if(hash==='#tasks') renderKanban();
      if(hash==='#habits') renderHabits();
      if(hash==='#calendar') renderCalendar();
      if(hash==='#settings') renderSettings();
    }
    window.addEventListener('hashchange', ()=> route(location.hash));
    document.querySelectorAll('.icon-btn[data-route]').forEach(b=> b.addEventListener('click', ()=> { location.hash = b.getAttribute('data-route'); if(window.innerWidth<720) document.getElementById('sidebar').classList.remove('open'); }));
    if(!location.hash) location.hash='#dashboard'; route(location.hash);

    // =================== Theme ===================
    const root = document.body; function applyTheme(t){ document.documentElement.setAttribute('data-theme', t); state.settings.theme = t; save(); }
    applyTheme(state.settings.theme || 'light');
    document.getElementById('themeToggle').addEventListener('click', ()=> applyTheme(document.documentElement.getAttribute('data-theme')==='dark' ? 'light' : 'dark'));
    document.querySelectorAll('[data-theme]').forEach(b=> b.addEventListener('click', ()=> applyTheme(b.getAttribute('data-theme'))));

    // =================== Dashboard ===================
    function renderDashboard(){
      document.getElementById('kpi-tasks').textContent = state.tasks.filter(t=> t.col !== 'done').length;
      document.getElementById('kpi-habits').textContent = state.habits.length;
      document.getElementById('kpi-streak').textContent = Math.max(0,...state.habits.map(h=>h.streak));

      // recent
      const recent = document.getElementById('recent'); recent.innerHTML='';
      state.tasks.slice(0,6).forEach(t=>{ const d = document.createElement('div'); d.className='muted'; d.style.padding='8px 0'; d.innerHTML = `<strong>${esc(t.title)}</strong> ‚Äî ${esc(t.desc||'')}`; recent.appendChild(d); });

      // mini kanban
      const mini = document.getElementById('miniKanban'); mini.innerHTML=''; ['todo','inprogress','done'].forEach(col=>{ const c = document.createElement('div'); c.style.minWidth='120px'; c.style.padding='8px'; c.style.borderRadius='10px'; c.style.background='linear-gradient(180deg,color-mix(in srgb,var(--panel) 96%, transparent),transparent)'; c.innerHTML = `<strong class="muted">${col.toUpperCase()}</strong>`; state.tasks.filter(t=>t.col===col).slice(0,3).forEach(t=>{ const e = document.createElement('div'); e.style.marginTop='8px'; e.textContent = t.title; c.appendChild(e); }); mini.appendChild(c); });

      // habits rings
      const dh = document.getElementById('dashHabits'); dh.innerHTML=''; state.habits.forEach(h=> dh.appendChild(createRing(h)));

      // sparklines
      drawSpark('sparkTasks', state.tasks.map((_,i)=> Math.random()*10 + i));
      drawSpark('sparkHabits', state.habits.map((_,i)=> Math.random()*5 + i));
      drawSpark('sparkProd', Array.from({length:12},()=> Math.random()*10));
    }

    // =================== Kanban ===================
    function renderKanban(){ const lists = {todo:document.querySelector('[data-list="todo"]'), inprogress:document.querySelector('[data-list="inprogress"]'), done:document.querySelector('[data-list="done"]')}; Object.values(lists).forEach(n=> n.innerHTML='');
      state.tasks.forEach(t=>{ const item = makeTaskElem(t); lists[t.col].appendChild(item); });
      initDnD();
    }

    function makeTaskElem(t){ const tpl = document.getElementById('taskTpl'); const node = tpl.content.firstElementChild.cloneNode(true);
      node.dataset.id = t.id; node.querySelector('.t-title').textContent = t.title; node.querySelector('.t-desc').textContent = t.desc || ''; node.querySelector('.t-meta').textContent = new Date(t.created).toLocaleString(); node.querySelector('.t-edit').addEventListener('click', ()=> editTask(t.id)); node.querySelector('.t-del').addEventListener('click', ()=> { if(confirm('Delete this task?')){ state.tasks = state.tasks.filter(x=>x.id!==t.id); save(); renderKanban(); renderDashboard(); } }); return node; }

    function editTask(id){ const t = state.tasks.find(x=>x.id===id); const title = prompt('Edit title', t.title); if(title!==null){ t.title = title; save(); renderKanban(); renderDashboard(); } }

    // DnD
    function initDnD(){ const draggables = document.querySelectorAll('.task-card'); draggables.forEach(d=>{
        d.addEventListener('dragstart', e=>{ d.classList.add('dragging'); e.dataTransfer.setData('text/plain', d.dataset.id); setTimeout(()=> d.style.display='none', 0); });
        d.addEventListener('dragend', e=>{ d.classList.remove('dragging'); d.style.display='block'; });
      });
      const cols = document.querySelectorAll('.col-list'); cols.forEach(c=>{
        c.addEventListener('dragover', e=>{ e.preventDefault(); c.style.background = 'rgba(100,100,100,0.03)'; });
        c.addEventListener('dragleave', e=>{ c.style.background = ''; });
        c.addEventListener('drop', e=>{ e.preventDefault(); c.style.background=''; const id = e.dataTransfer.getData('text/plain'); const task = state.tasks.find(x=>x.id===id); if(task){ task.col = c.getAttribute('data-list'); save(); renderKanban(); renderDashboard(); } });
      }); }

    document.getElementById('addTodo').addEventListener('click', ()=>{ const t = { id:id(), title: prompt('Task title') || 'Untitled', desc:'', col:'todo', created:Date.now() }; if(!t.title) return; state.tasks.unshift(t); save(); renderKanban(); renderDashboard(); });
    document.getElementById('newQuick').addEventListener('click', ()=>{ const t = { id:id(), title: prompt('Quick task'), desc:'', col:'todo', created:Date.now() }; if(!t.title) return; state.tasks.unshift(t); save(); renderKanban(); renderDashboard(); location.hash='#tasks'; });

    // =================== Habits ===================
    function renderHabits(){ const node = document.getElementById('habitsFull'); node.innerHTML=''; state.habits.forEach(h=> node.appendChild(createHabitCard(h))); renderDashboard(); }
    function createHabitCard(h){ const el = document.createElement('div'); el.className='card ring'; el.style.textAlign='center'; el.innerHTML = `<svg width="84" height="84" viewBox="0 0 36 36" style="display:block;margin:auto"><path stroke="#eee" stroke-width="4" fill="none" d="M18 2.0845a15.9155 15.9155 0 1 1 0 31.831A15.9155 15.9155 0 0 1 18 2.0845"/><path stroke="url(#g)" stroke-width="4" stroke-dasharray="${Math.round(h.progress*100)},100" stroke-linecap="round" fill="none" d="M18 2.0845a15.9155 15.9155 0 1 1 0 31.831A15.9155 15.9155 0 0 1 18 2.0845" /><defs><linearGradient id="g" x1="0" x2="1"><stop offset="0%" stop-color="var(--accent-1)" /><stop offset="100%" stop-color="var(--accent-2)" /></linearGradient></defs></svg>
                      <div style="margin-top:8px"><strong>${esc(h.title)}</strong></div>
                      <div class="muted">${h.streak} day streak</div>
                      <div style="margin-top:8px"><button class="icon-btn" data-incr="${h.id}">Ôºã</button> <button class="icon-btn" data-del="${h.id}">‚úï</button></div>`; return el; }

    document.getElementById('addHabitFull').addEventListener('click', ()=>{ const name = prompt('New habit name'); if(!name) return; state.habits.push({id:id(), title:name, streak:0, progress:0}); save(); renderHabits(); });
    document.getElementById('habitsFull').addEventListener('click', e=>{ const id = e.target.dataset.incr || e.target.dataset.del; if(!id) return; if(e.target.dataset.incr){ const h = state.habits.find(x=>x.id===id); h.streak++; h.progress = Math.min(1, h.progress + 0.12); save(); renderHabits(); } else if(e.target.dataset.del){ if(confirm('Delete habit?')){ state.habits = state.habits.filter(x=>x.id!==id); save(); renderHabits(); } } });

    // =================== Calendar ===================
    function renderCalendar(){ const grid = document.getElementById('calendarGrid'); grid.innerHTML=''; const now = new Date(); const month = now.getMonth(); const year = now.getFullYear(); document.getElementById('monthLabel').textContent = now.toLocaleString(undefined,{month:'long', year:'numeric'});
      const first = new Date(year, month, 1); const start = first.getDay(); const days = new Date(year, month+1, 0).getDate();
      ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(d=>{ const h = document.createElement('div'); h.className='muted'; h.style.textAlign='center'; grid.appendChild(h); });
      for(let i=0;i<start;i++) grid.appendChild(document.createElement('div'));
      for(let d=1; d<=days; d++){ const el = document.createElement('div'); el.className='day'; el.innerHTML = `<strong>${d}</strong>`; // mark tasks on that day
        const tasks = state.tasks.filter(t=> t.due && new Date(t.due).getDate()===d ); tasks.slice(0,3).forEach(t=>{ const dot = document.createElement('div'); dot.textContent = '‚Ä¢ ' + t.title; dot.style.fontSize='12px'; dot.style.marginTop='6px'; el.appendChild(dot); }); grid.appendChild(el); }
    }

    // =================== Settings ===================
    function renderSettings(){ document.getElementById('settingName').value = state.settings.name || ''; document.getElementById('settingEmail').value = state.settings.email || ''; }
    document.getElementById('saveSettings').addEventListener('click', ()=>{ state.settings.name = document.getElementById('settingName').value; state.settings.email = document.getElementById('settingEmail').value; save(); alert('Saved'); });

    // theme buttons
    document.querySelectorAll('[data-theme]').forEach(b=> b.addEventListener('click', ()=> applyTheme(b.getAttribute('data-theme'))));

    // density
    document.getElementById('densityCompact').addEventListener('click', ()=> { document.documentElement.style.setProperty('--radius','8px'); state.settings.density='compact'; save(); });
    document.getElementById('densityDefault').addEventListener('click', ()=> { document.documentElement.style.setProperty('--radius','16px'); state.settings.density='default'; save(); });

    // =================== Utilities ===================
    function esc(s){ return String(s).replace(/[&<>\"]/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]||c)); }

    // simple sparkline drawing
    function drawSpark(id, arr){ const c = document.getElementById(id); if(!c) return; const ctx = c.getContext('2d'); const w = c.width; const h = c.height; ctx.clearRect(0,0,w,h); ctx.lineWidth=2; ctx.beginPath(); const mx = Math.max(...arr); const mn = Math.min(...arr); arr.forEach((v,i)=>{ const x = (i/(arr.length-1))*(w-8)+4; const y = h - ((v - mn)/(mx - mn || 1))*(h-8) -4; if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y); }); ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--accent-1') || '#6d28d9'; ctx.stroke(); }

    // small sparkline draw for existing ones
    document.querySelectorAll('.spark').forEach(c=> drawSpark(c.id, Array.from({length:8},()=>Math.random()*10)));

    // =================== Global search & shortcuts ===================
    document.getElementById('globalSearch').addEventListener('keydown', e=>{ if(e.key==='Enter'){ const q = e.target.value.trim(); if(q){ // go to tasks and filter
          location.hash = '#tasks'; setTimeout(()=>{ // set a simple filter by title (we're using prompt workflow for brevity)
            const found = state.tasks.find(t=> t.title.toLowerCase().includes(q.toLowerCase())); if(found) alert('Found: '+found.title); }, 200); } } });
    document.addEventListener('keydown', e=>{ if(e.target.tagName.toLowerCase()==='input') return; if(e.key==='n'){ const t = { id:id(), title: prompt('New task title'), desc:'', col:'todo', created:Date.now() }; if(t.title) { state.tasks.unshift(t); save(); renderKanban(); renderDashboard(); location.hash='#tasks'; } } if(e.key==='/'){ e.preventDefault(); document.getElementById('globalSearch').focus(); } });

    // initial renders
    renderDashboard(); renderKanban(); renderHabits(); renderCalendar(); renderSettings();

  </script>
</body>
</html>
